<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="redflag package" href="../redflag.html" /><link rel="prev" title="🚩 Basic usage" href="Basic_usage.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><meta name="generator" content="sphinx-5.3.0, furo 2022.09.29"/>
        <title>🚩 Using redflag with sklearn - redflag documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">redflag  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/redflag_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">🚩 Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basic_usage.html">🚩 Basic usage</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">🚩 Using <code class="docutils literal notranslate"><span class="pre">redflag</span></code> with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../redflag.html">redflag package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/redflag/">PyPI releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/agilescientific/redflag">Code in GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/agilescientific/redflag/issues">Issue tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://code.agilescientific.com/community">Community guidelines</a></li>
<li class="toctree-l1"><a class="reference external" href="https://code.agilescientific.com">Agile's software</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.agilescientific.com">Agile's website</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="using-redflag-with-sklearn">
<h1>🚩 Using <code class="docutils literal notranslate"><span class="pre">redflag</span></code> with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code><a class="headerlink" href="#using-redflag-with-sklearn" title="Permalink to this heading">#</a></h1>
<p>As well as using <code class="docutils literal notranslate"><span class="pre">redflag</span></code>’s functions directly (see <code class="docutils literal notranslate"><span class="pre">Basic_usage.ipynb</span></code>), <code class="docutils literal notranslate"><span class="pre">redflag</span></code> has some <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> transformers that you can use to detect possible issues in your data.</p>
<p>⚠️ <strong>Note that these transformers do not transform your data, they only raise warnings (red flags) if they find issues.</strong></p>
<p>Let’s load some example data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://geocomp.s3.amazonaws.com/data/Panoma_training_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># Look at the transposed summary: each column in the DataFrame is a row here.</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Depth</th>
      <td>3966.0</td>
      <td>882.674555</td>
      <td>40.150056</td>
      <td>784.402800</td>
      <td>858.012000</td>
      <td>888.339600</td>
      <td>913.028400</td>
      <td>963.320400</td>
    </tr>
    <tr>
      <th>RelPos</th>
      <td>3966.0</td>
      <td>0.524999</td>
      <td>0.286375</td>
      <td>0.010000</td>
      <td>0.282000</td>
      <td>0.531000</td>
      <td>0.773000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>Marine</th>
      <td>3966.0</td>
      <td>1.325013</td>
      <td>0.589539</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>GR</th>
      <td>3966.0</td>
      <td>64.367899</td>
      <td>28.414603</td>
      <td>12.036000</td>
      <td>45.311250</td>
      <td>64.840000</td>
      <td>78.809750</td>
      <td>200.000000</td>
    </tr>
    <tr>
      <th>ILD</th>
      <td>3966.0</td>
      <td>5.240308</td>
      <td>3.190416</td>
      <td>0.340408</td>
      <td>3.169567</td>
      <td>4.305266</td>
      <td>6.664234</td>
      <td>32.136605</td>
    </tr>
    <tr>
      <th>DeltaPHI</th>
      <td>3966.0</td>
      <td>3.469088</td>
      <td>4.922310</td>
      <td>-21.832000</td>
      <td>1.000000</td>
      <td>3.292500</td>
      <td>6.124750</td>
      <td>18.600000</td>
    </tr>
    <tr>
      <th>PHIND</th>
      <td>3966.0</td>
      <td>13.008807</td>
      <td>6.936391</td>
      <td>0.550000</td>
      <td>8.196250</td>
      <td>11.781500</td>
      <td>16.050000</td>
      <td>52.369000</td>
    </tr>
    <tr>
      <th>PE</th>
      <td>3966.0</td>
      <td>3.686427</td>
      <td>0.815113</td>
      <td>0.200000</td>
      <td>3.123000</td>
      <td>3.514500</td>
      <td>4.241750</td>
      <td>8.094000</td>
    </tr>
    <tr>
      <th>Facies</th>
      <td>3966.0</td>
      <td>4.471004</td>
      <td>2.406180</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>6.000000</td>
      <td>9.000000</td>
    </tr>
    <tr>
      <th>LATITUDE</th>
      <td>3966.0</td>
      <td>37.632575</td>
      <td>0.299398</td>
      <td>37.180732</td>
      <td>37.356426</td>
      <td>37.500380</td>
      <td>37.910583</td>
      <td>38.063373</td>
    </tr>
    <tr>
      <th>LONGITUDE</th>
      <td>3966.0</td>
      <td>-101.294895</td>
      <td>0.230454</td>
      <td>-101.646452</td>
      <td>-101.389189</td>
      <td>-101.325130</td>
      <td>-101.106045</td>
      <td>-100.987305</td>
    </tr>
    <tr>
      <th>ILD_log10</th>
      <td>3966.0</td>
      <td>0.648860</td>
      <td>0.251542</td>
      <td>-0.468000</td>
      <td>0.501000</td>
      <td>0.634000</td>
      <td>0.823750</td>
      <td>1.507000</td>
    </tr>
    <tr>
      <th>RHOB</th>
      <td>3966.0</td>
      <td>2288.861692</td>
      <td>218.038459</td>
      <td>1500.000000</td>
      <td>2201.007475</td>
      <td>2342.202051</td>
      <td>2434.166399</td>
      <td>2802.871147</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that the features (e.g. GR, RHOB) are not <strong>independent</strong> records; they are correlated to themselves in depth.</p>
<p>Furthermore, some of these features are clipped, e.g. the GR feature is clipped at a max value of 200:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GR&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;GR&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="../_images/dff40fb0048731fdea605328ffc1f44f59ed2ae8ec1cce0f902fe6f990d7b578.png" src="../_images/dff40fb0048731fdea605328ffc1f44f59ed2ae8ec1cce0f902fe6f990d7b578.png" />
</div>
</div>
<p>We will split this dataset by group (well name):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GR&#39;</span><span class="p">,</span> <span class="s1">&#39;RHOB&#39;</span><span class="p">,</span> <span class="s1">&#39;PE&#39;</span><span class="p">]</span>

<span class="n">test_wells</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRAWFORD&#39;</span><span class="p">,</span> <span class="s1">&#39;STUART&#39;</span><span class="p">]</span>

<span class="n">test_flag</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Well Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">test_wells</span><span class="p">)</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_flag</span><span class="p">,</span> <span class="n">features</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_flag</span><span class="p">,</span> <span class="s1">&#39;Lithology&#39;</span><span class="p">]</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">test_flag</span><span class="p">,</span> <span class="n">features</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">test_flag</span><span class="p">,</span> <span class="s1">&#39;Lithology&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="the-redflag-detector-classes">
<h2>The <code class="docutils literal notranslate"><span class="pre">redflag</span></code> detector classes<a class="headerlink" href="#the-redflag-detector-classes" title="Permalink to this heading">#</a></h2>
<p>There are two main kinds of object: <strong>detectors</strong> and <strong>comparators</strong>.</p>
<p><strong>Detectors</strong> look for problems in your training and/or subsequent (e.g. validation, test, or production) data and are mostly unsupervised. There are several detectors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ClipDetector()</span></code> — looks for features that have been clipped.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CorrelationDetector()</span></code> — looks for features that are correlated to themselves, which indicates that the data are likely not IID (in particular, not independent).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UnivariateOutlierDetector()</span></code> — looks for outliers, considering each feature separately. Usually, you probably want to use <code class="docutils literal notranslate"><span class="pre">OutlierDetector</span></code> instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MultivariateOutlierDetector()</span></code> — looks for outliers, considering all the features together. Usually, you probably want to use <code class="docutils literal notranslate"><span class="pre">OutlierDetector</span></code> instead.</p></li>
</ul>
<p>The following detectors only run during training. In other words, they examine your data during model fitting, but do not look at data during subsequent calls to <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">score</span></code>, etc.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ImportanceDetector()</span></code> — looks at feature importance. Runs during <code class="docutils literal notranslate"><span class="pre">fit</span></code> only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ImbalanceDetector()</span></code> — looks for class imbalance in <code class="docutils literal notranslate"><span class="pre">y</span></code>. Runs during <code class="docutils literal notranslate"><span class="pre">fit</span></code> only. In other words, it can find class imbalance in the training data, but does not look at data during subsequent calls to <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">score</span></code>, etc.</p></li>
</ul>
<p>Finally, one detector is a bit different from the others because it runs in unsupervised mode on the training data, but in supervised mode on subsequent data. In other words, it can find outliers in the training data (based on some threshold), then it uses the statistics of the training data to decide what is an outlier in the subsequent data:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OutlierDetector()</span></code> — looks for outliers. Runs during <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p></li>
</ul>
<p><strong>Comparators</strong> are fully supervised. They learn things about your data during training, then look at subsequent (e.g. validation, test, or production) data and compare. They will not triger during model fitting, only during <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">score</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DistributionComparator()</span></code> — checks that the distributions of the features are similar to those seen during training.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ImbalanceComparator()</span></code>— checks that any class imbalance is similar to that seen during training. (Does not trigger if the training data is imbalanced; use <code class="docutils literal notranslate"><span class="pre">ImbalanceDetector</span></code> for that.) Note that this comparator does not work in ordinary <code class="docutils literal notranslate"><span class="pre">sklearn.pipeline.Pipeline</span></code> objects; use <code class="docutils literal notranslate"><span class="pre">redflag.RfPipeline</span></code> instead.</p></li>
</ul>
</section>
<section id="using-the-pre-built-redflag-pipeline">
<h2>Using the pre-built <code class="docutils literal notranslate"><span class="pre">redflag</span></code> pipeline<a class="headerlink" href="#using-the-pre-built-redflag-pipeline" title="Permalink to this heading">#</a></h2>
<p>There is a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"><code class="docutils literal notranslate"><span class="pre">sklearn.pipeline.Pipeline</span></code></a> you can use, containing most of the detectors. To find out why one is not included, and why, read on.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ImbalanceComparator</span></code>, is not compatible with ordinary <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> objects, because it requires <code class="docutils literal notranslate"><span class="pre">y</span></code> (class imbalance comparison only works on the target vector). An <code class="docutils literal notranslate"><span class="pre">RfPipeline</span></code> object is available to use with this comparator… but it will not work as part of another ordinary <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code>, so if you compose a multi-pipeline pipeline, make sure to use <code class="docutils literal notranslate"><span class="pre">RfPipeline</span></code> for all of it. Please note there is also a <code class="docutils literal notranslate"><span class="pre">make_rf_pipeline()</span></code> function that works just like <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code>, but it uses <code class="docutils literal notranslate"><span class="pre">RfPipeline</span></code> instead.</p>
<p>For now, we’ll carry on with the standard <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> pipeline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">redflag</span> <span class="k">as</span> <span class="nn">rf</span>

<span class="n">rf</span><span class="o">.</span><span class="n">pipeline</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                (&#x27;rf.clip&#x27;, ClipDetector()),
                (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                (&#x27;rf.outlier&#x27;, OutlierDetector()),
                (&#x27;rf.distributions&#x27;, DistributionComparator()),
                (&#x27;rf.importance&#x27;, ImportanceDetector())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                (&#x27;rf.clip&#x27;, ClipDetector()),
                (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                (&#x27;rf.outlier&#x27;, OutlierDetector()),
                (&#x27;rf.distributions&#x27;, DistributionComparator()),
                (&#x27;rf.importance&#x27;, ImportanceDetector())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">ImbalanceDetector</label><div class="sk-toggleable__content"><pre>ImbalanceDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">ClipDetector</label><div class="sk-toggleable__content"><pre>ClipDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">CorrelationDetector</label><div class="sk-toggleable__content"><pre>CorrelationDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">OutlierDetector</label><div class="sk-toggleable__content"><pre>OutlierDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">DistributionComparator</label><div class="sk-toggleable__content"><pre>DistributionComparator()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">ImportanceDetector</label><div class="sk-toggleable__content"><pre>ImportanceDetector()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>We can use this in another pipeline:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">rf</span><span class="o">.</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">SVC</span><span class="p">())</span>
<span class="n">pipe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;pipeline&#x27;,
                 Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                                 (&#x27;rf.clip&#x27;, ClipDetector()),
                                 (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                                 (&#x27;rf.outlier&#x27;, OutlierDetector()),
                                 (&#x27;rf.distributions&#x27;, DistributionComparator()),
                                 (&#x27;rf.importance&#x27;, ImportanceDetector())])),
                (&#x27;svc&#x27;, SVC())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;pipeline&#x27;,
                 Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                                 (&#x27;rf.clip&#x27;, ClipDetector()),
                                 (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                                 (&#x27;rf.outlier&#x27;, OutlierDetector()),
                                 (&#x27;rf.distributions&#x27;, DistributionComparator()),
                                 (&#x27;rf.importance&#x27;, ImportanceDetector())])),
                (&#x27;svc&#x27;, SVC())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" ><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" ><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">pipeline: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                (&#x27;rf.clip&#x27;, ClipDetector()),
                (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                (&#x27;rf.outlier&#x27;, OutlierDetector()),
                (&#x27;rf.distributions&#x27;, DistributionComparator()),
                (&#x27;rf.importance&#x27;, ImportanceDetector())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" ><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">ImbalanceDetector</label><div class="sk-toggleable__content"><pre>ImbalanceDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" ><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">ClipDetector</label><div class="sk-toggleable__content"><pre>ClipDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox" ><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">CorrelationDetector</label><div class="sk-toggleable__content"><pre>CorrelationDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox" ><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">OutlierDetector</label><div class="sk-toggleable__content"><pre>OutlierDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox" ><label for="sk-estimator-id-15" class="sk-toggleable__label sk-toggleable__label-arrow">DistributionComparator</label><div class="sk-toggleable__content"><pre>DistributionComparator()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox" ><label for="sk-estimator-id-16" class="sk-toggleable__label sk-toggleable__label-arrow">ImportanceDetector</label><div class="sk-toggleable__content"><pre>ImportanceDetector()</pre></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox" ><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>During the <code class="docutils literal notranslate"><span class="pre">fit</span></code> phase, the <code class="docutils literal notranslate"><span class="pre">redflag</span></code> transformers do three things:</p>
<ul class="simple">
<li><p>Check the target <code class="docutils literal notranslate"><span class="pre">y</span></code> for imbalance (if it is categorical).</p></li>
<li><p>Check the input features <code class="docutils literal notranslate"><span class="pre">X</span></code> for issues like clipping and self-correlation.</p></li>
<li><p>Learn the input feature distributions for later comparison.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 The labels are imbalanced by more than the threshold (0.420 &gt; 0.400). See self.minority_classes_ for the minority classes.
🚩 Features 0, 1 may have clipped values.
🚩 Features 0, 1, 2 may have correlated values.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 There are more outliers than expected in the training data (349 vs 31).
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;pipeline&#x27;,
                 Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                                 (&#x27;rf.clip&#x27;, ClipDetector()),
                                 (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                                 (&#x27;rf.outlier&#x27;,
                                  OutlierDetector(threshold=3.3682141715600706)),
                                 (&#x27;rf.distributions&#x27;, DistributionComparator()),
                                 (&#x27;rf.importance&#x27;, ImportanceDetector())])),
                (&#x27;svc&#x27;, SVC())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox" ><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;pipeline&#x27;,
                 Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                                 (&#x27;rf.clip&#x27;, ClipDetector()),
                                 (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                                 (&#x27;rf.outlier&#x27;,
                                  OutlierDetector(threshold=3.3682141715600706)),
                                 (&#x27;rf.distributions&#x27;, DistributionComparator()),
                                 (&#x27;rf.importance&#x27;, ImportanceDetector())])),
                (&#x27;svc&#x27;, SVC())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox" ><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox" ><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">pipeline: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;rf.imbalance&#x27;, ImbalanceDetector()),
                (&#x27;rf.clip&#x27;, ClipDetector()),
                (&#x27;rf.correlation&#x27;, CorrelationDetector()),
                (&#x27;rf.outlier&#x27;, OutlierDetector(threshold=3.3682141715600706)),
                (&#x27;rf.distributions&#x27;, DistributionComparator()),
                (&#x27;rf.importance&#x27;, ImportanceDetector())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox" ><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">ImbalanceDetector</label><div class="sk-toggleable__content"><pre>ImbalanceDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox" ><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">ClipDetector</label><div class="sk-toggleable__content"><pre>ClipDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox" ><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">CorrelationDetector</label><div class="sk-toggleable__content"><pre>CorrelationDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" ><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">OutlierDetector</label><div class="sk-toggleable__content"><pre>OutlierDetector(threshold=3.3682141715600706)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox" ><label for="sk-estimator-id-25" class="sk-toggleable__label sk-toggleable__label-arrow">DistributionComparator</label><div class="sk-toggleable__content"><pre>DistributionComparator()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox" ><label for="sk-estimator-id-26" class="sk-toggleable__label sk-toggleable__label-arrow">ImportanceDetector</label><div class="sk-toggleable__content"><pre>ImportanceDetector()</pre></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox" ><label for="sk-estimator-id-27" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>When we pass in data for prediction, <code class="docutils literal notranslate"><span class="pre">redflag</span></code> checks the new inputs. There are two categories of check:</p>
<ul class="simple">
<li><p>Check for first-order issues, e.g. for clipping, or self-correlation.</p></li>
<li><p>Compare statistics to the training data, e.g. to compare the distribution of the data or look for outliers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 Feature 0 may have clipped values.
🚩 Features 0, 1, 2 may have correlated values.
🚩 There are more outliers than expected in the data (30 vs 8).
🚩 Feature 2 has a distribution that is different from training.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;,
       &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;,
       &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;,
       &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;, &#39;siltstone&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>But you can’t pass arguments to the elements of <code class="docutils literal notranslate"><span class="pre">redflag_pipeline</span></code> components yet, for example to change the sensitivity of the <code class="docutils literal notranslate"><span class="pre">DistributionComparator</span></code>. To do that, use them separately. That is, instantiate the detector components how you want them, and make a pipeline out of the components.</p>
</section>
<section id="using-the-detector-transformers">
<h2>Using the ‘detector’ transformers<a class="headerlink" href="#using-the-detector-transformers" title="Permalink to this heading">#</a></h2>
<p>Let’s construct a pipeline from <code class="docutils literal notranslate"><span class="pre">redflag</span></code>’s transformers directly.</p>
<p>Let’s drop the clipped records of the GR log.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;GR&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">]</span>

<span class="n">test_flag</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Well Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">test_wells</span><span class="p">)</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_flag</span><span class="p">,</span> <span class="n">features</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_flag</span><span class="p">,</span> <span class="s1">&#39;Lithology&#39;</span><span class="p">]</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">test_flag</span><span class="p">,</span> <span class="n">features</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">test_flag</span><span class="p">,</span> <span class="s1">&#39;Lithology&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We know all this data is correlated to itself, so we can leave that check out.</p>
<p>We don’t think the class imbalance is too troubling, so we raise the threshold on that.</p>
<p>We’ll lower the confidence level of the outlier detector to 80% (i.e. we expect 20% of the data points will likely qualify as outliers). This might still trigger the detector in the training data.</p>
<p>Finally, we’ll lower the threshold for the distribution comparison. This is the minimum Wasserstein distance required to trigger the warning.</p>
<p>So here’s the new pipeline:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span>
                     <span class="n">rf</span><span class="o">.</span><span class="n">ImbalanceDetector</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                     <span class="n">rf</span><span class="o">.</span><span class="n">ClipDetector</span><span class="p">(),</span>
                     <span class="n">rf</span><span class="o">.</span><span class="n">OutlierDetector</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.80</span><span class="p">),</span>
                     <span class="n">rf</span><span class="o">.</span><span class="n">DistributionComparator</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span>
                     <span class="n">SVC</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Remember, feature 0 is no longer clipped, and the correlation detection is not being run. So we expect to see only the outlier issue, and the clipping issue with the RHOB column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 Feature 1 may have clipped values.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 There are more outliers than expected in the training data (839 vs 626).
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;imbalancedetector&#x27;, ImbalanceDetector(threshold=0.5)),
                (&#x27;clipdetector&#x27;, ClipDetector()),
                (&#x27;outlierdetector&#x27;,
                 OutlierDetector(p=0.8, threshold=2.154443705823081)),
                (&#x27;distributioncomparator&#x27;,
                 DistributionComparator(threshold=0.25)),
                (&#x27;svc&#x27;, SVC())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox" ><label for="sk-estimator-id-28" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;standardscaler&#x27;, StandardScaler()),
                (&#x27;imbalancedetector&#x27;, ImbalanceDetector(threshold=0.5)),
                (&#x27;clipdetector&#x27;, ClipDetector()),
                (&#x27;outlierdetector&#x27;,
                 OutlierDetector(p=0.8, threshold=2.154443705823081)),
                (&#x27;distributioncomparator&#x27;,
                 DistributionComparator(threshold=0.25)),
                (&#x27;svc&#x27;, SVC())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox" ><label for="sk-estimator-id-29" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox" ><label for="sk-estimator-id-30" class="sk-toggleable__label sk-toggleable__label-arrow">ImbalanceDetector</label><div class="sk-toggleable__content"><pre>ImbalanceDetector(threshold=0.5)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox" ><label for="sk-estimator-id-31" class="sk-toggleable__label sk-toggleable__label-arrow">ClipDetector</label><div class="sk-toggleable__content"><pre>ClipDetector()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox" ><label for="sk-estimator-id-32" class="sk-toggleable__label sk-toggleable__label-arrow">OutlierDetector</label><div class="sk-toggleable__content"><pre>OutlierDetector(p=0.8, threshold=2.154443705823081)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox" ><label for="sk-estimator-id-33" class="sk-toggleable__label sk-toggleable__label-arrow">DistributionComparator</label><div class="sk-toggleable__content"><pre>DistributionComparator(threshold=0.25)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox" ><label for="sk-estimator-id-34" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>The test dataset does not trigger the higher threshold for outliers. But with the new lower Wasserstein threshold, the distribution comparison fails for all of the features:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 Features 0, 1, 2 have distributions that are different from training.
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-imbalance-comparator">
<h2>The imbalance comparator<a class="headerlink" href="#the-imbalance-comparator" title="Permalink to this heading">#</a></h2>
<p>As mentioned, the <code class="docutils literal notranslate"><span class="pre">ImbalanceComparator</span></code>, is not compatible with ordinary <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> objects, because it requires <code class="docutils literal notranslate"><span class="pre">y</span></code> (class imbalance comparison only works on the target vector). An <code class="docutils literal notranslate"><span class="pre">RfPipeline</span></code> object is available to use with this comparator… but it will not work as part of another ordinary <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> (for the same reason: <code class="docutils literal notranslate"><span class="pre">y</span></code> will not be passed into it), so if you compose a multi-pipeline pipeline, make sure to use <code class="docutils literal notranslate"><span class="pre">RfPipeline</span></code> for all of it.</p>
<p>There is also a <code class="docutils literal notranslate"><span class="pre">make_rf_pipeline()</span></code> function that works just like <code class="docutils literal notranslate"><span class="pre">make_pipeline</span></code>, but it uses <code class="docutils literal notranslate"><span class="pre">RfPipeline</span></code> instead.</p>
<p>Let’s use it to check whether the imbalance in our test data is similar to the imbalance in the training data. When fitting a model, the comparator will never trigger:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">make_rf_pipeline</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">ImbalanceComparator</span><span class="p">())</span>

<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RfPipeline(steps=[(&#x27;imbalancecomparator&#x27;, ImbalanceComparator())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox" ><label for="sk-estimator-id-35" class="sk-toggleable__label sk-toggleable__label-arrow">RfPipeline</label><div class="sk-toggleable__content"><pre>RfPipeline(steps=[(&#x27;imbalancecomparator&#x27;, ImbalanceComparator())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox" ><label for="sk-estimator-id-36" class="sk-toggleable__label sk-toggleable__label-arrow">ImbalanceComparator</label><div class="sk-toggleable__content"><pre>ImbalanceComparator()</pre></div></div></div></div></div></div></div></div></div>
</div>
<p>But during transformation (therefore during prediction or other inference phases), it checks the imbalance is the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>🚩 There is a different number of minority classes (2) compared to the training data (4).
🚩 The minority classes (sandstone, dolomite) are different from those in the training data (sandstone, wackestone, mudstone, dolomite).
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  66.276     , 2359.73324716,    3.591     ],
       [  77.252     , 2354.54679144,    3.341     ],
       [  82.899     , 2330.35783664,    3.064     ],
       ...,
       [  90.49      , 2193.06953439,    3.168     ],
       [  90.975     , 2192.32922081,    3.154     ],
       [  90.108     , 2176.62535394,    3.125     ]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="what-to-do-about-the-warnings">
<h2>What to do about the warnings<a class="headerlink" href="#what-to-do-about-the-warnings" title="Permalink to this heading">#</a></h2>
<p>If one of the detectors triggers, what should you do? Here are some ideas:</p>
<section id="imbalancedetector-and-imbalancecomparator">
<h3><code class="docutils literal notranslate"><span class="pre">ImbalanceDetector</span></code> and <code class="docutils literal notranslate"><span class="pre">ImbalanceComparator</span></code><a class="headerlink" href="#imbalancedetector-and-imbalancecomparator" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Check <code class="docutils literal notranslate"><span class="pre">rf.class_counts(y)</span></code> to see the support for each class in the dataset.</p></li>
<li><p>Check <code class="docutils literal notranslate"><span class="pre">rf.minority_classes(y)</span></code> to see which classes are considered ‘minority’.</p></li>
</ul>
<p>This detector does not run during <code class="docutils literal notranslate"><span class="pre">transform</span></code>, only during <code class="docutils literal notranslate"><span class="pre">fit</span></code>. Usually, we don’t worry about imbalance in data we are predicting on. If this is a concern for you, you can use <code class="docutils literal notranslate"><span class="pre">fit</span></code> on it (and make a GitHub Issue about it, because we could add an option to run during transform as well).</p>
</section>
<section id="clipdetector">
<h3><code class="docutils literal notranslate"><span class="pre">ClipDetector</span></code><a class="headerlink" href="#clipdetector" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Make sure the clipping values seem reasonable and do not lose a lot of dynamic range in the data (e.g. don’t clip daily temperatures for Europe at 0 and 25 deg C).</p></li>
<li><p>Check that the clipped data cannot be dealt with in some other way (e.g. you can attenuate very large values with a log transformation, if it makes sense in your data).</p></li>
<li><p>Check that the clipped data should not simply be dropped from the dataset (e.g. if there are only a few values out of many, or if the other features also look suspicious for those records).</p></li>
</ul>
<p>You may or may not be concerned about clipping. You may want to try training your models with and without the clipped records, to see if they make a difference to the model performance. I’m not aware of any research on this.</p>
</section>
<section id="correlationdetector">
<h3><code class="docutils literal notranslate"><span class="pre">CorrelationDetector</span></code><a class="headerlink" href="#correlationdetector" title="Permalink to this heading">#</a></h3>
<p>If the data is correlated to shifted versions of itself, e.g. because the data points are contiguous in time or space (daily temperature records, spatial measurements of rock properties, etc), then the so-called <a class="reference external" href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables">IID assumption</a> fails. In particular, your records are not independent. One of the big pitfalls with non-independent data is randomly splitting the data into train and test sets — you must not do this, it will result in information leakage and thus over-optimistic model evaulation. Instead, you should split the data using contiguous groups (date ranges, patient ID, borehole, or similar).</p>
</section>
<section id="outlierdetector">
<h3><code class="docutils literal notranslate"><span class="pre">OutlierDetector</span></code><a class="headerlink" href="#outlierdetector" title="Permalink to this heading">#</a></h3>
<p>There are a lot of ways of looking for outliers in data. The outlier detector only implements one strategy:</p>
<ul class="simple">
<li><p>Learn the robust location and covariance of the training data (you can think of these as outlier-insensitive, multi-dimensional analogs to mean and variance in a single random variable).</p></li>
<li><p>As with the Gaussian distribution, we expect a certain number of samples to fall far from the centre of this distribution. For example, we expect 99.7% of values to be within 3 standard deviations of the mean.</p></li>
<li><p>So, given a confidence level like 99.7%, <code class="docutils literal notranslate"><span class="pre">redflag</span></code> counts how many values are more than 3 SD’s away. If there are more than expected (e.g.  we expect 3 samples out of 1000), the detector is triggered.</p></li>
<li><p>The default confidence level is 99% (you expect 1% of the data to be noise), but you can change it.</p></li>
</ul>
<p>So the location and covariance are learned from the training data; the detector then runs on the training data and on future datasets during the prediction phase (test, val, and in production).</p>
<p>If the detector is triggered, you should check which samples are considered outliers with <code class="docutils literal notranslate"><span class="pre">rf.get_outliers(method='mah',</span> <span class="pre">p=0.99)</span></code> (without your value for <code class="docutils literal notranslate"><span class="pre">p</span></code>). This function returns the <em>indices</em> of the outlier samples. You can also use <code class="docutils literal notranslate"><span class="pre">rf.expected_outliers(*X.shape,</span> <span class="pre">p=0.99)</span></code> to check how many outliers you’d expect in the dataset, for a given value of <code class="docutils literal notranslate"><span class="pre">p</span></code>/.</p>
<p>You can check other methods, such as <code class="docutils literal notranslate"><span class="pre">iso</span></code> (isolation forest) to see if those also consider those samples to be outliers or not. If you think the samples are okay, you should keep them. If you think they are noise, you could remove them — but remember your model will not ‘know’ about these kinds of data points in the future and you should therefore remove them from future datasets too, before making predictions on them.</p>
</section>
<section id="distributioncomparator">
<h3><code class="docutils literal notranslate"><span class="pre">DistributionComparator</span></code><a class="headerlink" href="#distributioncomparator" title="Permalink to this heading">#</a></h3>
<p>Here’s what this thing does:</p>
<ul class="simple">
<li><p>When you call <code class="docutils literal notranslate"><span class="pre">fit</span></code> (e.g. during training), the detector learns the empirical, binned distributions of your features, one at a time. No warnings can be emitted during fitting, you are only learning the distributions.</p></li>
<li><p>When you call <code class="docutils literal notranslate"><span class="pre">transform</span></code> (e.g. during evaluation, testing, or in production), the detector compares the distributions in the data to those that were learned during fitting.</p></li>
<li><p>The comparison uses the <a class="reference external" href="https://en.wikipedia.org/wiki/Wasserstein_metric">1-Wasserstein distance</a>, or “earth mover’s distance”. Each feature is compared in turn; it is not a multivariate treatment. (If you’d like to see such a thing, please make a GitHub Issue, or have a crack at implementing it!)</p></li>
<li><p>If the distance is more than the threshold, 1 by default, the warning is triggered.</p></li>
</ul>
<p>If this detector triggers, it’s a sign that you may have violated the ‘identical  distribution’ part of the <a class="reference external" href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables">IID assumption</a>. You should examine the distributions of the features in the training data vs the current data that triggered the detector. For example, you can do this visually with something like Seaborn’s <code class="docutils literal notranslate"><span class="pre">displot</span></code> or <code class="docutils literal notranslate"><span class="pre">kdeplot</span></code> functions.</p>
<p>A small difference, especially on just a few features, might just result from natural variance in the data and you may decide to ignore it. A large difference may be a result of forgetting to scale the data using the scaling parameters learned from the training data. A large difference could also result from trying to apply the model to a new ‘domain’, e.g. a new geographic location, set of patients, or type of widget.</p>
<p>If you’re in the model selection phase, it’s possible that a different train/test split will give more comparable distributions.</p>
</section>
<section id="importancedetector">
<h3><code class="docutils literal notranslate"><span class="pre">ImportanceDetector</span></code><a class="headerlink" href="#importancedetector" title="Permalink to this heading">#</a></h3>
<p>This detector checks for both “too important” features and “not important enough” features, using thresholds you provide and some heuristics.</p>
<p>One or two very important features might indicate leakage: check that the features do not carry unintended information about the thing you are trying to predict. In particular, they should not carry information that will not be available to the model in production at prediction time. The classic example is trying to predict medical diagnosis using a patient number that contains encoded information about the patient’s diagnosis.</p>
<p>On the other hand, features with very low importance may not be useful to your model. If dimensionality is an issue, or the model is easily distracted by noise, you might improve performance by dropping one or more of these non-useful features. You will probably also improve the explainability of the model, which is often a desirable property.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../redflag.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">redflag package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Basic_usage.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">🚩 Basic usage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Agile Scientific
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://code.agilescientific.com" aria-label="Agile">
                <svg width="200" height="200" version="1.1" viewBox="0 0 187.5 187.5" xmlns="http://www.w3.org/2000/svg">
                <g transform="matrix(3.94 -1.28 1.28 3.94 -906.1 -3676)" style="color-rendering:auto;color:#000000;fill:#14ca29;image-rendering:auto;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;stroke-width:1px;text-decoration-color:#000000;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-transform:none;white-space:normal">
                <path d="m-46.98 936.1q3.515-1.622 6.705-3.244t5.083-2.379 3.028-0.757q1.893 0 3.244 1.298 1.406 1.244 1.406 3.136 0 1.081-0.7029 2.271-0.6489 1.136-1.406 1.46-6.975 2.758-15.36 4.001 1.514 1.406 3.731 3.731t2.325 2.487q0.8111 1.136 2.271 2.812 1.46 1.676 2.001 2.65 0.5948 0.9192 0.5948 2.271 0 1.73-1.298 3.028t-3.352 1.298q-2.055 0-4.65-3.19-2.541-3.19-6.597-11.46-4.109 7.462-5.515 9.841t-2.704 3.623q-1.298 1.19-2.974 1.19-2.001 0-3.352-1.352-1.298-1.406-1.298-2.974 0-1.46 0.5407-2.217 4.975-6.759 10.38-11.73-4.542-0.7029-8.111-1.568t-7.57-2.541q-0.6489-0.3244-1.298-1.46-0.5948-1.19-0.5948-2.163 0-1.893 1.352-3.136 1.406-1.298 3.19-1.298 1.298 0 3.244 0.8111 1.947 0.757 4.921 2.271 3.028 1.46 6.867 3.298-0.7029-3.407-1.19-7.786-0.4326-4.434-0.4326-6.056 0-2.001 1.244-3.407 1.298-1.46 3.298-1.46 1.947 0 3.19 1.46 1.298 1.406 1.298 3.785 0 0.6489-0.2163 2.595-0.1622 1.893-0.5407 4.65-0.3244 2.704-0.757 6.218z" style="fill:#14ca29"/>
                </g>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">🚩 Using <code class="docutils literal notranslate"><span class="pre">redflag</span></code> with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code></a><ul>
<li><a class="reference internal" href="#the-redflag-detector-classes">The <code class="docutils literal notranslate"><span class="pre">redflag</span></code> detector classes</a></li>
<li><a class="reference internal" href="#using-the-pre-built-redflag-pipeline">Using the pre-built <code class="docutils literal notranslate"><span class="pre">redflag</span></code> pipeline</a></li>
<li><a class="reference internal" href="#using-the-detector-transformers">Using the ‘detector’ transformers</a></li>
<li><a class="reference internal" href="#the-imbalance-comparator">The imbalance comparator</a></li>
<li><a class="reference internal" href="#what-to-do-about-the-warnings">What to do about the warnings</a><ul>
<li><a class="reference internal" href="#imbalancedetector-and-imbalancecomparator"><code class="docutils literal notranslate"><span class="pre">ImbalanceDetector</span></code> and <code class="docutils literal notranslate"><span class="pre">ImbalanceComparator</span></code></a></li>
<li><a class="reference internal" href="#clipdetector"><code class="docutils literal notranslate"><span class="pre">ClipDetector</span></code></a></li>
<li><a class="reference internal" href="#correlationdetector"><code class="docutils literal notranslate"><span class="pre">CorrelationDetector</span></code></a></li>
<li><a class="reference internal" href="#outlierdetector"><code class="docutils literal notranslate"><span class="pre">OutlierDetector</span></code></a></li>
<li><a class="reference internal" href="#distributioncomparator"><code class="docutils literal notranslate"><span class="pre">DistributionComparator</span></code></a></li>
<li><a class="reference internal" href="#importancedetector"><code class="docutils literal notranslate"><span class="pre">ImportanceDetector</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>